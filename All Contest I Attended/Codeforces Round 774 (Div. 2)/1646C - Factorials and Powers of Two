#include <bits/stdc++.h>
#include <unordered_map>
using namespace std;

using ll = long long;
using ull = unsigned long long;
using ld = long double;
using ui = unsigned int;

const int INF = 1e9;
const int SIZE = 1e5;
const int MOD = 1006903069;
const int MAX = 1e7 + 10;

const ll MAXA = 1000000000000LL;

/*
//	    _   __  ___  __   __ _______ _______
//	   / | / / / _ \ \ \__\ \\__  __\\  __  \
//	  /  |/ / / /_\ \ \  ___ \  \ \   \ \ \  \
//	 / /|  / / ____  \ \ \  \ \ _\ \___\ \/  /
//	/_/ |_/ /_/    \__\ \_\  \_\\______\\___/
//
// ID: mdnahidibnaharun
// LANG: C++
// TASK: practice
*/

int fbit(ll x) {
    return 63 - __builtin_clzll(x);
}

int bcnt(ll x) {
    return __builtin_popcountll(x);
}

void solve() {
    ll n;
    cin >> n;

    vector<ll> f;
    ll cur = 6, num = 4;
    while (cur <= MAXA) {
        f.push_back(cur);
        cur *= num;
        num++;
    }

    int m = f.size();
    vector<pair<ll, ll>> s(1 << m);
    s[0] = {0, 0};

    for (int mask = 1; mask < (1 << m); mask++) {
        int b = fbit(mask);
        s[mask].first = s[mask ^ (1 << b)].first + f[b];
        s[mask].second = bcnt(mask);
    }

    ll ans = bcnt(n);
    for (auto &x : s) {
        if (x.first <= n) {
            ans = min(ans, x.second + bcnt(n - x.first));
        }
    }

    cout << ans << endl;
}

int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(nullptr);

    int t;
    cin >> t;
    while (t--) {
        solve();
        // cout << endl;
    }

    return 0;
}
