#include<bits/stdc++.h>
using namespace std;
using ll = long long;
using ull = unsigned long long;
using ui = unsigned int;
const ll INF = 1e12+7;
/*
//      _   __  ___  __   __ _______ _______
//     / | / / / _ \ \ \__\ \\__  __\\  __  \ 
//    /  |/ / / /_\ \ \  ___ \  \ \   \ \ \  \ 
//   / /|  / / ____  \ \ \  \ \ _\ \___\ \/  /
//  /_/ |_/ /_/    \__\ \_\  \_\\______\\___/

ID: mdnahidibnaharun
LANG: C++
TASK: practice 
*/
vector<int>fun(vector<int>& ar){
    int n=(int)ar.size();
    vector<int>c(n+1,0);
    for(auto x:ar)if(0<=x && x<=n)c[x]++;
    int mex=0;
    while(mex<=n && c[mex]>0)mex++;
    vector<int>ans(n);
    for(int i=0;i<n;i++){
        if(0<=ar[i] && ar[i]<=n && ar[i]<mex && c[ar[i]]==1 )ans[i]=ar[i];
        else ans[i]=mex;
    }
    return ans;
}
void solve(){
   int n;ll k;cin>>n>>k;
   vector<int>a(n);for(auto &x:a)cin>>x;
   if(k ==0){
    ll ans=0;
    for(auto x:a)ans+=x;
    cout<<ans;return;
   }
   vector<int>a1=fun(a);
   if(k ==1){
    ll ans=0;
    for(auto x:a1)ans+=x;
    cout<<ans;return;
   }
   vector<int>a2=fun(a1);
   if(k==2){
    ll ans=0;
    for(auto x:a2)ans+=x;
    cout<<ans;return;
   }
   vector<int>a3=fun(a2);
   ll sa=0,sb=0;
   for(auto x:a2)sa+=x;
   for(auto x:a3)sb+=x;
   if(k%2==0)cout<<sa;
   else cout<<sb;

}
    
int main(){
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    int t;cin>>t;
    while(t--){
        solve();
        cout<<endl;
    }
return 0;
}
